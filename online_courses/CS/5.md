### 1. 세마포

- 임계구역 문제 해결 : acquire()로 들어오고 release()로 나가게 코드를 짠다. 예를 들어 이미 parent의 입금이 일어나고 있으면 critical section안의 value가 0보다 작아 child가 acquire를 요청해도 바로 실행되지 않고 block에 들어가있다. 그 후에 parent의 release가 일어난 후 value값이 변경되고 child가 실행할 수 있다.
- 프로세스 실행 순서 정하기 : 초기값 0. p1, p2에 s1, s2가 있는데 cpu 스케줄링 알고리즘과 관게없이 s1이 무조건 먼저 실행되게 하려면? p2의 acquire를 호출하면 1이 감소되게 한다. 그래서 s2가 실행되지 못한다. 그래서 s1이 먼저 실행되고 release가 +1을 하면서 음수가 아니라 s2가 실행될 수 있게 된다.



### 2. 생산자-소비자 문제  Producer -Consumer Problem

- 전통적 동기화 예제 
- 창고에 생산물을 저장해두면 소비자가 소비한다. 컴퓨터로 말하면 창고가 버퍼. 창고가 가득차면 생산을 중단해야 한다.
- 생산자가 데이터를 생산하면 소비자는 소비
- 컴파일러 > 어셈블러(기계어로 번역해서 컴퓨터가 실행할 수 있게 해준다), 파일 서버 > 클라이언트, 웹 서버 > 웹 클라이언트
- 유한버퍼 문제(Bounded Buffer Problem) : 생산된 데이터는 버퍼에 일단 저장(생산과 소비의 속도 차이 같은 이유), 현실 시스템에서 버퍼 크기는 유한, 생산자는 버퍼가 가득 차면 더 넣을 수 없고 소비자는 버퍼가 비면 뺄 수 없다.
- 잘못된 결과 : 실행 불가 또는 생산된 항목 숫자와 소비된 항목 숫자 다름. 최종적으로 버퍼에 0개가 있어야 한다.
  - 이유 : 공통변수 count, buff[]에 대한 동시 업데이트로 공동변수 업데이트 구간(임계구역)에 동시 진입
  - 해결법 : 임계구역에 대한 동시 접근 방지(상호 배타), 임계구역 전에 mutex.acquire() 끝나고 murtex.release()
  - Busy-wait : 생산자를 위한 빈 공간, 소비자를 위한 찬 공간이 있어야한다. 기다리는 동안 cpu가 계속 조건을 체크하면서 무한루프 하는데 이게 busy-wait고 좋지 않다. 낭비를 없애기 위해 버퍼가 꽉 차 있으면 무한 루프가 아니라 세마포 감옥에 가두기.



### 3. 기타 전통적 동기화 문제

- Readers-Writers Problem : 공통 데이터베이스에 접근. 데이터베이스가 critical section이지만 한 번에 한 명만 들어오게 하는 건 비효율적. 리더가 읽고있을 때 다른 리더가 들어와도 된다. 어차피 리더는 읽기만 하고 변경하지 않으니까. -> 효율성 재고
- 리더 프로세스한테 우선권을 준다. first r/w probelm
- 라이터한테 우선권을 준다. second r/w problem
- 아무에게나 준다. third r/w problem

- Dining Philosopher Problem : 식사하는 철학자 문제. 5명의 철학자와 5개의 젓가락이 있다. 생각->식사->생각->식사 ... 식사하려면 2개의 젓가락 필요. 한 명이 젓가락을 들면 옆에 앉은 사람은 못든다. 왼, 오 젓가락을 각각 세마포로 만든다. 두 젓가락을 사용할 때 acquire, 식사 끝나면 release한 후 thinking. 
  - 잘못된 결과 : starvation 이유는 교착상태(deadlock). 두 철학자가 동시에 배가고프다면? 
  - 조건에 따라 왼 오 젓가락 드는 순서를 바꾸면 교착상태가 일어나지 않을 수 있다. (해결 중 하나)
- 교착상태(Deadlocks)
  - 프로세스는 실행을 위해 여러 자원이 필요하다. cpu, memory, file 등
  - 자원은 한정됐는데 프로세스는 많다. 그래서 잘못 나눠주면 대기할 때 교착상태가 발생할 수 있다. 
  - 필요조건 : 상호배타(Mutual exclusion), 보유 및 대기(Hold and Wait), 비선점(No Preemption), 환형대기(Circular Wait) => 4가지 조건을 모두 만족하면 일어날 수도 있다. 잘 안일어난다는 말
- 자원(Resource)
  - 동일 자원 : 동일 형식 자원이 여러 개 있을 수 있다.(cpu 2개, 동일 프린터 3개 등)
  - 자원의 사용 : 요청 -> 사용 -> 반납
  - 자원 할당도 : 어떤 자원이 어떤 프로세스에게 할당되었나? 어떤 프로세스가 할당받기 위해 기다리고 있는가? (자원 : 사각형, 프로세스 : 원, 할당 : 화살표, 프로세스가 자원으로 화살표를 보내면 요청, 반대는 할당) 이 그림에서 원이 만들어지는게 환형대기(화살표 방향까지 맞게)
  - 자원 내 인스턴스